"use strict";var _get=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,i,n)}if("value"in s)return s.value;var o=s.get;return void 0!==o?o.call(n):void 0},_createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(t,e){"undefined"!=typeof module&&"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e():"function"==typeof define&&(define.amd||define.cmd)?define(function(){return e}):t.Ppath2D=e()}("undefined"!=typeof window?window:global,function(){var t=function(){function t(e){_classCallCheck(this,t),this.moduleBase={name:e||"No module base name."}}return _createClass(t,[{key:"each",value:function(t,e){if("object"===(void 0===t?"undefined":_typeof(t)))if(Array.isArray(t))for(var i=t.length,n=0;n<i;n++){if("_break"===e(t[n],n))break}else for(var s in t){if("_break"===e(t[s],s))break}else this.systemError("each","Not a object or array.",t)}},{key:"systemError",value:function(t,e,i){throw i&&(console.log("%c error object is : ","color:#FFF; background:red"),console.log(i)),new Error("(☉д⊙)!! "+this.moduleBase.name+" => "+t+" -> "+e)}}]),t}(),e=function(e){function i(t,e){_classCallCheck(this,i);var n=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,"Path"));(n.points=[],n.length=0,t)&&("string"===(void 0===t?"undefined":_typeof(t))&&n.compile(t.trim(),e));return n}return _inherits(i,t),_createClass(i,[{key:"compile",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"path",n={a:"arc",m:"moveTo",l:"lineTo",h:"horizontalLineTo",v:"verticalLineTo",c:"curve",q:"quadraticBezierCurve",s:"smoothCurve",t:"smoothQuadraticBezierCurve",z:"closePath"};if("path"===i){for(var s=Object.keys(n),r=-1,o=[""],a=0;a<t.length;a++)/[a-zA-z]/.test(t[a])&&(o[r+=1]=""),"-"===t[a]&&(o[r]+=" "),o[r]+=t[a];this.each(o,function(t){var i=t.trim(),r=i.slice(0,1),o=i.slice(1).split(/,|\s/).filter(function(t){return""!==t}).map(function(t){return Number(t)});-1!==s.indexOf(r.toLowerCase())?/[a-z]/.test(r)?e[n[r.toLowerCase()]].apply(e,_toConsumableArray(o).concat([!1])):e[n[r.toLowerCase()]].apply(e,_toConsumableArray(o).concat([!0])):e.systemError("compile","Key name not found",r)})}else if("polygon"===i){for(var h="",u=0;u<t.length;u++)"-"===t[u]&&(h+=" "),h+=t[u];t=h.split(/,|\s/).filter(function(t){return""!==t}).map(function(t){return Number(t)});this.moveTo(t[0],t[1],!0);for(var l=2;l<t.length;l+=2)this.lineTo(t[l],t[l+1],!0);this.closePath()}}},{key:"eachPoint",value:function(t){for(var e=this.points.length,i=0;i<e;i++)t(this.points[i])}},{key:"addPoint",value:function(t){t.error&&this.systemError("addPoint",t.error,t),this.points.push(t),this.length+=t.length}},{key:"addPath",value:function(t){this.compile(t.toString())}},{key:"refresh",value:function(){var t=this;this.length=0,this.eachPoint(function(e){e.refresh(),t.length+=e.length})}},{key:"render",value:function(t){t.beginPath(),this.eachPoint(function(e){e.render(t)})}},{key:"toPathString",value:function(){this.eachPoint(function(t){t.toPathString()})}},{key:"getLastPoint",value:function(){return 0===this.points.length?this:this.points.slice(-1)[0]}},{key:"getLastPosition",value:function(){var t=0!==this.points.length?this.points.slice(-1)[0].getLastPosition():null;return t||{x:0,y:0}}},{key:"getLinePosition",value:function(t){for(var e=null,i=this.length*t,n=this.points.length,s=0;s<n;s++)if(i<=this.points[s].length){if(this.points[s]){e=this.points[s];break}}else i-=this.points[s].length;return e?e.getLinePosition(i/e.length):this.getLastPosition()}},{key:"getDirection",value:function(t){var e=t+.01,n=this.getLinePosition(t),s=this.getLinePosition(e);return i.Math.getAngle(n.x,n.y,s.x,s.y)-270}},{key:"moveTo",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.addPoint(new i.PointBase.MoveTo(this,t,e,n)),this}},{key:"lineTo",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.addPoint(new i.PointBase.LineTo(this,this.getLastPoint(),t,e,n)),this}},{key:"curve",value:function(t,e,n,s,r,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return this.addPoint(new i.PointBase.Curve(this,this.getLastPoint(),t,e,n,s,r,o,a)),this}},{key:"quadraticBezierCurve",value:function(t,e,n,s){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this.addPoint(new i.PointBase.QuadraticBezierCurve(this,this.getLastPoint(),t,e,n,s,r)),this}},{key:"smoothCurve",value:function(t,e,n,s){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this.addPoint(new i.PointBase.SmoothCurve(this,this.getLastPoint(),t,e,n,s,r)),this}},{key:"smoothQuadraticBezierCurve",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.addPoint(new i.PointBase.SmoothQuadraticBezierCurve(this,this.getLastPoint(),t,e,n)),this}},{key:"horizontalLineTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.addPoint(new i.PointBase.HorizontalLineTo(this,this.getLastPoint(),t,e)),this}},{key:"verticalLineTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.addPoint(new i.PointBase.VerticalLineTo(this,this.getLastPoint(),t,e)),this}},{key:"arc",value:function(t,e,n,s,r,o,a){var h=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return this.addPoint(new i.PointBase.Arc(this,this.getLastPoint(),t,e,n,s,r,o,a,h)),this}},{key:"closePath",value:function(){return this.addPoint(new i.PointBase.ClosePath(this,this.getLastPoint())),this}}]),i}();return e.Math=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"getDistance",value:function(t,e,i,n){return Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2))}},{key:"getAngle",value:function(t,e,i,n){if(t==i&&e==n)return 0;var s=180*Math.atan2(n-e,i-t)/Math.PI;return s>0?s:360+s}}]),t}(),e.PointBase=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,t),this.error=null,this.absolute=!!n,this.initData(),this.resetReference(e,i),this.refresh()}return _createClass(t,[{key:"resetReference",value:function(t,e){this.path=t,this.parent=e||this.parent}},{key:"initData",value:function(){this.length=0,this.data={p1x:0,p1y:0,p2x:0,p2y:0,ex:0,ey:0}}},{key:"reset",value:function(t){for(var e in t)null!=this.data[e]&&(this[e]=t[e]);this.refresh()}},{key:"refresh",value:function(){this.length=this.getLength()}},{key:"getLength",value:function(){return 0}},{key:"getLastPosition",value:function(){return{x:this.ex,y:this.ey}}},{key:"getType",value:function(){return this.toPathString().trim()[0]}},{key:"sx",get:function(){return this.parent.ex}},{key:"sy",get:function(){return this.parent.ey}},{key:"ex",get:function(){return this.absolute?this.data.ex:this.data.ex+this.sx},set:function(t){this.data.ex=t}},{key:"ey",get:function(){return this.absolute?this.data.ey:this.data.ey+this.sy},set:function(t){this.data.ey=t}},{key:"p1x",get:function(){return this.absolute?this.data.p1x:this.data.p1x+this.sx},set:function(t){this.data.p1x=t}},{key:"p1y",get:function(){return this.absolute?this.data.p1y:this.data.p1y+this.sy},set:function(t){this.data.p1y=t}},{key:"p2x",get:function(){return this.absolute?this.data.p2x:this.data.p2x+this.sx},set:function(t){this.data.p2x=t}},{key:"p2y",get:function(){return this.absolute?this.data.p2y:this.data.p2y+this.sy},set:function(t){this.data.p2y=t}}]),t}(),e.PointBase.MoveTo=function(t){function i(t,e,n,s){_classCallCheck(this,i);var r=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,{ex:0,ey:0},s));return r.reset({ex:e,ey:n}),r}return _inherits(i,e.PointBase),_createClass(i,[{key:"render",value:function(t){t.moveTo(this.ex,this.ey)}},{key:"toPathString",value:function(){return(this.absolute?"M":"m")+this.ex+","+this.ey}},{key:"getLinePosition",value:function(t){return{x:this.ex,y:this.ey}}}]),i}(),e.PointBase.LineTo=function(t){function i(t,e,n,s,r){_classCallCheck(this,i);var o=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,r));return o.reset({ex:n,ey:s}),o}return _inherits(i,e.PointBase),_createClass(i,[{key:"render",value:function(t){t.lineTo(this.ex,this.ey)}},{key:"toPathString",value:function(){return(this.absolute?"L":"l")+this.ex+","+this.ey}},{key:"getLinePosition",value:function(t){return{x:this.sx*(1-t)+this.ex*t,y:this.sy*(1-t)+this.ey*t}}},{key:"getLength",value:function(){return e.Math.getDistance(this.sx,this.sy,this.ex,this.ey)}}]),i}(),e.PointBase.HorizontalLineTo=function(t){function i(t,e,n,s){return _classCallCheck(this,i),_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,n,0,s))}return _inherits(i,e.PointBase.LineTo),_createClass(i,[{key:"toPathString",value:function(){return(this.absolute?"H":"h")+this.ex}}]),i}(),e.PointBase.VerticalLineTo=function(t){function i(t,e,n,s){return _classCallCheck(this,i),_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,0,n,s))}return _inherits(i,e.PointBase.LineTo),_createClass(i,[{key:"toPathString",value:function(){return(this.absolute?"V":"v")+this.ey}}]),i}(),e.PointBase.Curve=function(t){function i(t,e,n,s,r,o,a,h){var u=arguments.length>8&&void 0!==arguments[8]&&arguments[8];_classCallCheck(this,i);var l=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,u));return l.reset({p1x:n,p1y:s,p2x:r,p2y:o,ex:a,ey:h}),l}return _inherits(i,e.PointBase),_createClass(i,[{key:"getStep",value:function(){return 100}},{key:"getPoint",value:function(t,e,i,n,s){return e*(1-t)*(1-t)*(1-t)+3*i*(1-t)*(1-t)*t+3*n*(1-t)*t*t+s*t*t*t}},{key:"getLength",value:function(){for(var t=0,e=0,i=0,n=0,s=this.getStep(),r=0,o=0,a=0;a<=s;a++){if(i=a/s,t=this.getPoint(i,this.sx,this.p1x,this.p2x,this.ex),e=this.getPoint(i,this.sy,this.p1y,this.p2y,this.ey),a>0){var h=t-r,u=e-o;n+=Math.sqrt(h*h+u*u)}r=t,o=e}return n}},{key:"render",value:function(t){t.bezierCurveTo(this.p1x,this.p1y,this.p2x,this.p2y,this.ex,this.ey)}},{key:"toPathString",value:function(){return(this.absolute?"C":"c")+this.p1x+","+this.p1y+","+this.p2x+","+this.p2y+","+this.ex+","+this.ey}},{key:"getLinePosition",value:function(t){return{x:this.getPoint(t,this.sx,this.p1x,this.p2x,this.ex),y:this.getPoint(t,this.sy,this.p1y,this.p2y,this.ey)}}}]),i}(),e.PointBase.QuadraticBezierCurve=function(t){function i(t,e,n,s,r,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return _classCallCheck(this,i),_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,n,s,n,s,r,o,a))}return _inherits(i,e.PointBase.Curve),_createClass(i,[{key:"render",value:function(t){t.quadraticCurveTo(this.p1x,this.p1y,this.ex,this.ey)}},{key:"toPathString",value:function(){return(this.absolute?"Q":"q")+this.p1x+","+this.p1y+","+this.ex+","+this.ey}},{key:"getPoint",value:function(t,e,i,n,s){return(1-t)*(1-t)*e+2*t*(1-t)*i+t*t*s}},{key:"p2x",get:function(){return this.p1x},set:function(t){this.data.p2x=t}},{key:"p2y",get:function(){return this.p1y},set:function(t){this.data.p2y=t}}]),i}(),e.PointBase.SmoothCurve=function(t){function i(t,e,n,s,r,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return _classCallCheck(this,i),_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,0,0,n,s,r,o,a))}return _inherits(i,e.PointBase.Curve),_createClass(i,[{key:"render",value:function(t){t.bezierCurveTo(this.p1x,this.p1y,this.p2x,this.p2y,this.ex,this.ey)}},{key:"toPathString",value:function(){return(this.absolute?"S":"s")+this.p2x+","+this.p2y+","+this.ex+","+this.ey}},{key:"parentIsCurve",get:function(){return!!this.parent.getType().toLowerCase().match(/q|c|s|t/)}},{key:"p1x",get:function(){return this.parentIsCurve?2*this.parent.ex-this.parent.p2x:this.p2x},set:function(t){this.data.p1x=t}},{key:"p1y",get:function(){return this.parentIsCurve?2*this.parent.ey-this.parent.p2y:this.p2y},set:function(t){this.data.p1y=t}}]),i}(),e.PointBase.SmoothQuadraticBezierCurve=function(t){function i(t,e,n,s){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];_classCallCheck(this,i);var o=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,0,0,0,0,n,s,r));return"q"!==e.getType().toLowerCase()&&(o.error="Smooth Quadratic BezierCurve previous point must a Quadratic Bezier Curve."),o}return _inherits(i,e.PointBase.Curve),_createClass(i,[{key:"render",value:function(t){t.quadraticCurveTo(this.p1x,this.p1y,this.ex,this.ey)}},{key:"toPathString",value:function(){return(this.absolute?"T":"t")+this.ex+","+this.ey}},{key:"getPoint",value:function(t,e,i,n,s){return(1-t)*(1-t)*e+2*t*(1-t)*i+t*t*s}},{key:"p2x",get:function(){return this.p1x},set:function(t){}},{key:"p2y",get:function(){return this.p1y},set:function(t){}},{key:"p1x",get:function(){return 2*this.parent.ex-this.parent.p1x},set:function(t){}},{key:"p1y",get:function(){return 2*this.parent.ey-this.parent.p1y},set:function(t){}}]),i}(),e.PointBase.Arc=function(t){function i(t,e,n,s,r,o,a,h,u){var l=arguments.length>9&&void 0!==arguments[9]&&arguments[9];_classCallCheck(this,i);var c=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,l));return c.rx=n,c.ry=s,c.sweepFlag=a,c.largeArcFlag=o,c.xAxisRotation=r,c.reset({ex:h,ey:u}),c}return _inherits(i,e.PointBase),_createClass(i,[{key:"reset",value:function(t){this.rx=t.rx?t.rx:this.rx,this.ry=t.ry?t.ry:this.ry,this.sweepFlag=t.sweepFlag?t.sweepFlag:this.sweepFlag,this.largeArcFlag=t.largeArcFlag?t.largeArcFlag:this.largeArcFlag,this.xAxisRotation=t.xAxisRotation?t.xAxisRotation:this.xAxisRotation,_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"reset",this).call(this,t)}},{key:"getStep",value:function(){return 100}},{key:"render",value:function(t){for(var e=this.getStep(),i=0;i<e;i+=1){var n=this.getLinePosition(i/e);t.lineTo(n.x,n.y)}}},{key:"toPathString",value:function(){return(this.absolute?"A":"a")+this.rx+","+this.ry+","+this.xAxisRotation+","+this.largeArcFlag+","+this.sweepFlag+","+this.ex+","+this.ey}},{key:"angleBetween",value:function(t,e){var i=t.x*e.x+t.y*e.y,n=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(i/n)}},{key:"getLinePosition",value:function(t){var e=Math.abs(this.rx),i=Math.abs(this.ry),n=Math.pow(e,2),s=Math.pow(i,2),r=this.xAxisRotation%360*(Math.PI/180),o=Math.cos(r),a=Math.sin(r);if(this.sx===this.ex&&this.sy===this.ey)return{x:this.sx,y:this.sy};if(0===e||0===i)return{x:this.sx*(1-t)+this.ex*t,y:this.sy*(1-t)+this.ey*t};var h=(this.sx-this.ex)/2,u=(this.sy-this.ey)/2,l={x:o*h+a*u,y:-a*h+o*u},c=Math.pow(l.x,2),y=Math.pow(l.y,2),f=c/n+y/s;if(f>1){var p=Math.sqrt(f);e*=p,i*=p}var g=(n*s-n*y-s*c)/(n*y+s*c);g=g<0?0:g;var v=(this.largeArcFlag!==this.sweepFlag?1:-1)*Math.sqrt(g),x=v*(e*l.y/i),d=v*(-i*l.x/e),P=o*x-a*d+(this.sx+this.ex)/2,_=a*x+o*d+(this.sy+this.ey)/2,k={x:(l.x-x)/e,y:(l.y-d)/i},C=this.angleBetween({x:1,y:0},k),b={x:(-l.x-x)/e,y:(-l.y-d)/i},m=this.angleBetween(k,b),w=2*Math.PI;!this.sweepFlag&&m>0?m-=w:this.sweepFlag&&m<0&&(m+=w);var L=C+(m%=w)*t,B=e*Math.cos(L),O=i*Math.sin(L);return{x:o*B-a*O+P,y:a*B+o*O+_}}},{key:"getDistance",value:function(t,i){return e.Math.getDistance(t.x,t.y,i.x,i.y)}},{key:"getLength",value:function(){for(var t,e=this.getStep(),i=0,n=this.getLinePosition(0),s=0;s<e;s++){var r=Math.min(Math.max(s*(1/e),0),1);t=this.getLinePosition(r),i+=this.getDistance(n,t),n=t}return t=this.getLinePosition(1),i+=this.getDistance(n,t)}}]),i}(),e.PointBase.ClosePath=function(t){function i(t,e){return _classCallCheck(this,i),_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e,0,0))}return _inherits(i,e.PointBase.LineTo),_createClass(i,[{key:"render",value:function(t){t.closePath()}},{key:"toPathString",value:function(){return"z"}},{key:"ex",get:function(){return this.path.points[0].ex},set:function(t){}},{key:"ey",get:function(){return this.path.points[0].ey},set:function(t){}}]),i}(),e});