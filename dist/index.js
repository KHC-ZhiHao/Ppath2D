"use strict";var _get=function t(e,i,n){null===e&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,i);if(void 0===s){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,i,n)}if("value"in s)return s.value;var o=s.get;return void 0!==o?o.call(n):void 0},_createClass=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(t,e){"undefined"!=typeof module&&"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e():"function"==typeof define&&(define.amd||define.cmd)?define(function(){return e}):t.Ppath2D=e()}("undefined"!=typeof window?window:global,function(){var e=function(){function e(t){_classCallCheck(this,e),this.moduleBase={name:t||"No module base name."}}return _createClass(e,[{key:"each",value:function(t,e){if("object"===(void 0===t?"undefined":_typeof(t)))if(Array.isArray(t))for(var i=t.length,n=0;n<i;n++){if("_break"===e(t[n],n))break}else for(var s in t){if("_break"===e(t[s],s))break}else this.systemError("each","Not a object or array.",t)}},{key:"systemError",value:function(t,e,i){throw i&&(console.log("%c error object is : ","color:#FFF; background:red"),console.log(i)),new Error("(☉д⊙)!! "+this.moduleBase.name+" => "+t+" -> "+e)}}]),e}(),i=function(t){function h(t,e){_classCallCheck(this,h);var i=_possibleConstructorReturn(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,"Path"));(i.points=[],i.length=0,t)&&("string"===(void 0===t?"undefined":_typeof(t))&&i.compile(t.trim(),e));return i}return _inherits(h,e),_createClass(h,[{key:"compile",value:function(t){var s=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"path",r={a:"arc",m:"moveTo",l:"lineTo",h:"horizontalLineTo",v:"verticalLineTo",c:"curve",q:"quadraticBezierCurve",s:"smoothCurve",t:"smoothQuadraticBezierCurve",z:"closePath"};if("path"===e){for(var o=Object.keys(r),i=-1,n=[""],a=0;a<t.length;a++)/[a-zA-z]/.test(t[a])&&(n[i+=1]=""),"-"===t[a]&&(n[i]+=" "),n[i]+=t[a];this.each(n,function(t){var e=t.trim(),i=e.slice(0,1),n=e.slice(1).split(/,|\s/).filter(function(t){return""!==t}).map(function(t){return Number(t)});-1!==o.indexOf(i.toLowerCase())?/[a-z]/.test(i)?s[r[i.toLowerCase()]].apply(s,_toConsumableArray(n).concat([!1])):s[r[i.toLowerCase()]].apply(s,_toConsumableArray(n).concat([!0])):s.systemError("compile","Key name not found",i)})}else if("polygon"===e){for(var h="",u=0;u<t.length;u++)"-"===t[u]&&(h+=" "),h+=t[u];t=h.split(/,|\s/).filter(function(t){return""!==t}).map(function(t){return Number(t)});this.moveTo(t[0],t[1],!0);for(var c=2;c<t.length;c+=2)this.lineTo(t[c],t[c+1],!0);this.closePath()}}},{key:"eachPoint",value:function(t){for(var e=this.points.length,i=0;i<e;i++)t(this.points[i])}},{key:"addPoint",value:function(t){t.error&&this.systemError("addPoint",t.error,t),this.points.push(t),this.length+=t.length}},{key:"addPath",value:function(t){t instanceof h?this.compile(t.toPathString()):this.systemError("addPath","Object not a Ppath2D data.",t)}},{key:"refresh",value:function(){var e=this;this.length=0,this.eachPoint(function(t){t.refresh(),e.length+=t.length})}},{key:"render",value:function(e){e.beginPath(),this.eachPoint(function(t){t.render(e)})}},{key:"toPathString",value:function(){var e="";return this.eachPoint(function(t){e+=t.toPathString()}),e}},{key:"getLastPoint",value:function(){return 0===this.points.length?{ex:0,ey:0}:this.points.slice(-1)[0]}},{key:"getLastPosition",value:function(){var t=0!==this.points.length?this.points.slice(-1)[0].getLastPosition():null;return t||{x:0,y:0}}},{key:"getLinePosition",value:function(t){for(var e=null,i=this.length*t,n=this.points.length,s=0;s<n;s++)if(i<=this.points[s].length){if(this.points[s]){e=this.points[s];break}}else i-=this.points[s].length;return e?e.getLinePosition(i/e.length):this.getLastPosition()}},{key:"getDirection",value:function(t){var e=t+.01,i=this.getLinePosition(t),n=this.getLinePosition(e);return h.Math.getAngle(i.x,i.y,n.x,n.y)-270}},{key:"moveTo",value:function(t,e){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return this.addPoint(new h.PointBase.MoveTo(this,this.getLastPoint(),t,e,i)),this}},{key:"lineTo",value:function(t,e){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return this.addPoint(new h.PointBase.LineTo(this,this.getLastPoint(),t,e,i)),this}},{key:"curve",value:function(t,e,i,n,s,r){var o=6<arguments.length&&void 0!==arguments[6]&&arguments[6];return this.addPoint(new h.PointBase.Curve(this,this.getLastPoint(),t,e,i,n,s,r,o)),this}},{key:"quadraticBezierCurve",value:function(t,e,i,n){var s=4<arguments.length&&void 0!==arguments[4]&&arguments[4];return this.addPoint(new h.PointBase.QuadraticBezierCurve(this,this.getLastPoint(),t,e,i,n,s)),this}},{key:"smoothCurve",value:function(t,e,i,n){var s=4<arguments.length&&void 0!==arguments[4]&&arguments[4];return this.addPoint(new h.PointBase.SmoothCurve(this,this.getLastPoint(),t,e,i,n,s)),this}},{key:"smoothQuadraticBezierCurve",value:function(t,e){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return this.addPoint(new h.PointBase.SmoothQuadraticBezierCurve(this,this.getLastPoint(),t,e,i)),this}},{key:"horizontalLineTo",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return this.addPoint(new h.PointBase.HorizontalLineTo(this,this.getLastPoint(),t,e)),this}},{key:"verticalLineTo",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return this.addPoint(new h.PointBase.VerticalLineTo(this,this.getLastPoint(),t,e)),this}},{key:"arc",value:function(t,e,i,n,s,r,o){var a=7<arguments.length&&void 0!==arguments[7]&&arguments[7];return this.addPoint(new h.PointBase.Arc(this,this.getLastPoint(),t,e,i,n,s,r,o,a)),this}},{key:"closePath",value:function(){var t=this.points.filter(function(t){return t instanceof h.PointBase.MoveTo}).pop();return this.addPoint(new h.PointBase.ClosePath(this,this.getLastPoint(),t)),this}}]),h}();return i.Math=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"getDistance",value:function(t,e,i,n){return Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2))}},{key:"getAngle",value:function(t,e,i,n){if(t==i&&e==n)return 0;var s=180*Math.atan2(n-e,i-t)/Math.PI;return 0<s?s:360+s}}]),t}(),i.PointBase=function(){function n(t,e){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,n),this.error=null,this.absolute=!!i,this.initData(),this.resetReference(t,e),this.refresh()}return _createClass(n,[{key:"resetReference",value:function(t,e){this.path=t,this.parent=e||this.parent}},{key:"initData",value:function(){this.length=0,this.data={p1x:0,p1y:0,p2x:0,p2y:0,ex:0,ey:0}}},{key:"reset",value:function(t){for(var e in t)null!=this.data[e]&&(this[e]=t[e]);this.refresh()}},{key:"refresh",value:function(){this.length=this.getLength()}},{key:"getLength",value:function(){return 0}},{key:"getLastPosition",value:function(){return{x:this.ex,y:this.ey}}},{key:"getType",value:function(){return this.toPathString().trim()[0]}},{key:"sx",get:function(){return this.parent.ex}},{key:"sy",get:function(){return this.parent.ey}},{key:"ex",get:function(){return this.absolute?this.data.ex:this.data.ex+this.sx},set:function(t){this.data.ex=t}},{key:"ey",get:function(){return this.absolute?this.data.ey:this.data.ey+this.sy},set:function(t){this.data.ey=t}},{key:"p1x",get:function(){return this.absolute?this.data.p1x:this.data.p1x+this.sx},set:function(t){this.data.p1x=t}},{key:"p1y",get:function(){return this.absolute?this.data.p1y:this.data.p1y+this.sy},set:function(t){this.data.p1y=t}},{key:"p2x",get:function(){return this.absolute?this.data.p2x:this.data.p2x+this.sx},set:function(t){this.data.p2x=t}},{key:"p2y",get:function(){return this.absolute?this.data.p2y:this.data.p2y+this.sy},set:function(t){this.data.p2y=t}}]),n}(),i.PointBase.MoveTo=function(t){function o(t,e,i,n,s){_classCallCheck(this,o);var r=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,e,s));return r.reset({ex:i,ey:n}),r}return _inherits(o,i.PointBase),_createClass(o,[{key:"render",value:function(t){t.moveTo(this.ex,this.ey)}},{key:"toPathString",value:function(){return"M"+this.ex+","+this.ey}},{key:"getLinePosition",value:function(t){return{x:this.ex,y:this.ey}}}]),o}(),i.PointBase.LineTo=function(t){function o(t,e,i,n,s){_classCallCheck(this,o);var r=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,e,s));return r.reset({ex:i,ey:n}),r}return _inherits(o,i.PointBase),_createClass(o,[{key:"render",value:function(t){t.lineTo(this.ex,this.ey)}},{key:"toPathString",value:function(){return"L"+this.ex+","+this.ey}},{key:"getLinePosition",value:function(t){return{x:this.sx*(1-t)+this.ex*t,y:this.sy*(1-t)+this.ey*t}}},{key:"getLength",value:function(){return i.Math.getDistance(this.sx,this.sy,this.ex,this.ey)}}]),o}(),i.PointBase.HorizontalLineTo=function(t){function s(t,e,i,n){return _classCallCheck(this,s),_possibleConstructorReturn(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,t,e,i,n?e.ey:0,n))}return _inherits(s,i.PointBase.LineTo),_createClass(s,[{key:"toPathString",value:function(){return"H"+this.ex}}]),s}(),i.PointBase.VerticalLineTo=function(t){function s(t,e,i,n){return _classCallCheck(this,s),_possibleConstructorReturn(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,t,e,n?e.ex:0,i,n))}return _inherits(s,i.PointBase.LineTo),_createClass(s,[{key:"toPathString",value:function(){return"V"+this.ey}}]),s}(),i.PointBase.Curve=function(t){function c(t,e,i,n,s,r,o,a){var h=8<arguments.length&&void 0!==arguments[8]&&arguments[8];_classCallCheck(this,c);var u=_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,t,e,h));return u.reset({p1x:i,p1y:n,p2x:s,p2y:r,ex:o,ey:a}),u}return _inherits(c,i.PointBase),_createClass(c,[{key:"getStep",value:function(){return 100}},{key:"getPoint",value:function(t,e,i,n,s){return e*(1-t)*(1-t)*(1-t)+3*i*(1-t)*(1-t)*t+3*n*(1-t)*t*t+s*t*t*t}},{key:"getLength",value:function(){for(var t=0,e=0,i=0,n=0,s=this.getStep(),r=0,o=0,a=0;a<=s;a++){if(i=a/s,t=this.getPoint(i,this.sx,this.p1x,this.p2x,this.ex),e=this.getPoint(i,this.sy,this.p1y,this.p2y,this.ey),0<a){var h=t-r,u=e-o;n+=Math.sqrt(h*h+u*u)}r=t,o=e}return n}},{key:"render",value:function(t){t.bezierCurveTo(this.p1x,this.p1y,this.p2x,this.p2y,this.ex,this.ey)}},{key:"toPathString",value:function(){return"C"+this.p1x+","+this.p1y+","+this.p2x+","+this.p2y+","+this.ex+","+this.ey}},{key:"getLinePosition",value:function(t){return{x:this.getPoint(t,this.sx,this.p1x,this.p2x,this.ex),y:this.getPoint(t,this.sy,this.p1y,this.p2y,this.ey)}}}]),c}(),i.PointBase.QuadraticBezierCurve=function(t){function a(t,e,i,n,s,r){var o=6<arguments.length&&void 0!==arguments[6]&&arguments[6];return _classCallCheck(this,a),_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t,e,i,n,i,n,s,r,o))}return _inherits(a,i.PointBase.Curve),_createClass(a,[{key:"render",value:function(t){t.quadraticCurveTo(this.p1x,this.p1y,this.ex,this.ey)}},{key:"toPathString",value:function(){return"Q"+this.p1x+","+this.p1y+","+this.ex+","+this.ey}},{key:"getPoint",value:function(t,e,i,n,s){return(1-t)*(1-t)*e+2*t*(1-t)*i+t*t*s}},{key:"p2x",get:function(){return this.p1x},set:function(t){this.data.p2x=t}},{key:"p2y",get:function(){return this.p1y},set:function(t){this.data.p2y=t}}]),a}(),i.PointBase.SmoothCurve=function(t){function a(t,e,i,n,s,r){var o=6<arguments.length&&void 0!==arguments[6]&&arguments[6];return _classCallCheck(this,a),_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t,e,0,0,i,n,s,r,o))}return _inherits(a,i.PointBase.Curve),_createClass(a,[{key:"render",value:function(t){t.bezierCurveTo(this.p1x,this.p1y,this.p2x,this.p2y,this.ex,this.ey)}},{key:"toPathString",value:function(){return"S"+this.p2x+","+this.p2y+","+this.ex+","+this.ey}},{key:"parentIsCurve",get:function(){return!!this.parent.getType().toLowerCase().match(/q|c|s|t/)}},{key:"p1x",get:function(){return this.parentIsCurve?2*this.parent.ex-this.parent.p2x:this.p2x},set:function(t){this.data.p1x=t}},{key:"p1y",get:function(){return this.parentIsCurve?2*this.parent.ey-this.parent.p2y:this.p2y},set:function(t){this.data.p1y=t}}]),a}(),i.PointBase.SmoothQuadraticBezierCurve=function(t){function o(t,e,i,n){var s=4<arguments.length&&void 0!==arguments[4]&&arguments[4];_classCallCheck(this,o);var r=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,e,0,0,0,0,i,n,s));return"q"!==e.getType().toLowerCase()&&(r.error="Smooth Quadratic BezierCurve previous point must a Quadratic Bezier Curve."),r}return _inherits(o,i.PointBase.Curve),_createClass(o,[{key:"render",value:function(t){t.quadraticCurveTo(this.p1x,this.p1y,this.ex,this.ey)}},{key:"toPathString",value:function(){return"T"+this.ex+","+this.ey}},{key:"getPoint",value:function(t,e,i,n,s){return(1-t)*(1-t)*e+2*t*(1-t)*i+t*t*s}},{key:"p2x",get:function(){return this.p1x},set:function(t){}},{key:"p2y",get:function(){return this.p1y},set:function(t){}},{key:"p1x",get:function(){return 2*this.parent.ex-this.parent.p1x},set:function(t){}},{key:"p1y",get:function(){return 2*this.parent.ey-this.parent.p1y},set:function(t){}}]),o}(),i.PointBase.Arc=function(t){function l(t,e,i,n,s,r,o,a,h){var u=9<arguments.length&&void 0!==arguments[9]&&arguments[9];_classCallCheck(this,l);var c=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,t,e,u));return c.rx=i,c.ry=n,c.sweepFlag=o,c.largeArcFlag=r,c.xAxisRotation=s,c.reset({ex:a,ey:h}),c}return _inherits(l,i.PointBase),_createClass(l,[{key:"reset",value:function(t){this.rx=t.rx?t.rx:this.rx,this.ry=t.ry?t.ry:this.ry,this.sweepFlag=t.sweepFlag?t.sweepFlag:this.sweepFlag,this.largeArcFlag=t.largeArcFlag?t.largeArcFlag:this.largeArcFlag,this.xAxisRotation=t.xAxisRotation?t.xAxisRotation:this.xAxisRotation,_get(l.prototype.__proto__||Object.getPrototypeOf(l.prototype),"reset",this).call(this,t)}},{key:"getStep",value:function(){return 100}},{key:"render",value:function(t){for(var e=this.getStep(),i=0;i<e;i+=1){var n=this.getLinePosition(i/e);t.lineTo(n.x,n.y)}}},{key:"toPathString",value:function(){return"A"+this.rx+","+this.ry+","+this.xAxisRotation+","+this.largeArcFlag+","+this.sweepFlag+","+this.ex+","+this.ey}},{key:"angleBetween",value:function(t,e){var i=t.x*e.x+t.y*e.y,n=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(i/n)}},{key:"getLinePosition",value:function(t){var e=Math.abs(this.rx),i=Math.abs(this.ry),n=Math.pow(e,2),s=Math.pow(i,2),r=this.xAxisRotation%360*(Math.PI/180),o=Math.cos(r),a=Math.sin(r);if(this.sx===this.ex&&this.sy===this.ey)return{x:this.sx,y:this.sy};if(0===e||0===i)return{x:this.sx*(1-t)+this.ex*t,y:this.sy*(1-t)+this.ey*t};var h=(this.sx-this.ex)/2,u=(this.sy-this.ey)/2,c={x:o*h+a*u,y:-a*h+o*u},l=Math.pow(c.x,2),y=Math.pow(c.y,2),f=l/n+y/s;if(1<f){var p=Math.sqrt(f);e*=p,i*=p}var v=(n*s-n*y-s*l)/(n*y+s*l);v=v<0?0:v;var g=(this.largeArcFlag!==this.sweepFlag?1:-1)*Math.sqrt(v),x=g*(e*c.y/i),d=g*(-i*c.x/e),P=o*x-a*d+(this.sx+this.ex)/2,_=a*x+o*d+(this.sy+this.ey)/2,k={x:(c.x-x)/e,y:(c.y-d)/i},C=this.angleBetween({x:1,y:0},k),b={x:(-c.x-x)/e,y:(-c.y-d)/i},m=this.angleBetween(k,b),w=2*Math.PI;!this.sweepFlag&&0<m?m-=w:this.sweepFlag&&m<0&&(m+=w);var L=C+(m%=w)*t,B=e*Math.cos(L),O=i*Math.sin(L);return{x:o*B-a*O+P,y:a*B+o*O+_}}},{key:"getDistance",value:function(t,e){return i.Math.getDistance(t.x,t.y,e.x,e.y)}},{key:"getLength",value:function(){for(var t,e=this.getStep(),i=0,n=this.getLinePosition(0),s=0;s<e;s++){var r=Math.min(Math.max(s*(1/e),0),1);t=this.getLinePosition(r),i+=this.getDistance(n,t),n=t}return t=this.getLinePosition(1),i+=this.getDistance(n,t)}}]),l}(),i.PointBase.ClosePath=function(t){function n(t,e,i){return _classCallCheck(this,n),_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e,i.ex,i.ey,i.absolute))}return _inherits(n,i.PointBase.LineTo),_createClass(n,[{key:"render",value:function(t){t.closePath()}},{key:"toPathString",value:function(){return"z"}}]),n}(),i});