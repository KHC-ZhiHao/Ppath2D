"use strict";var _get=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0},_createClass=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(t,e){"undefined"!=typeof module&&"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e():"function"==typeof define&&(define.amd||define.cmd)?define(function(){return e}):t.Ppath2D=e()}("undefined"!=typeof window?window:global,function(){var e=function(){function e(t){_classCallCheck(this,e),this.moduleBase={name:t||"No module base name."}}return _createClass(e,[{key:"each",value:function(t,e){if("object"===(void 0===t?"undefined":_typeof(t)))if(Array.isArray(t))for(var i=t.length,n=0;n<i;n++){if("_break"===e(t[n],n))break}else for(var r in t){if("_break"===e(t[r],r))break}else this.systemError("each","Not a object or array.",t)}},{key:"systemError",value:function(t,e,i){throw i&&(console.log("%c error object is : ","color:#FFF; background:red"),console.log(i)),new Error("(☉д⊙)!! "+this.moduleBase.name+" => "+t+" -> "+e)}}]),e}(),t=function(t){function n(t,e){_classCallCheck(this,n);var i=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,"Path"));(i.points=[],i.length=0,i.cacheMode=!1,i.siteCaches=[],t)&&("string"===(void 0===t?"undefined":_typeof(t))&&i.compile(t.trim(),e));return i}return _inherits(n,e),_createClass(n,[{key:"setCache",value:function(t){this.cacheMode=!!t,this.siteCaches=[]}},{key:"compile",value:function(t){var r=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"path",s={a:"arc",m:"moveTo",l:"lineTo",h:"horizontalLineTo",v:"verticalLineTo",c:"curve",q:"quadraticBezierCurve",s:"smoothCurve",t:"smoothQuadraticBezierCurve",z:"closePath"};if("path"===e){for(var o=Object.keys(s),i=-1,n=[""],a=0;a<t.length;a++)/[a-zA-z]/.test(t[a])&&(n[i+=1]=""),"-"===t[a]&&(n[i]+=" "),n[i]+=t[a];this.each(n,function(t){var e=t.trim(),i=e.slice(0,1),n=e.slice(1).split(/,|\s/).filter(function(t){return""!==t}).map(function(t){return Number(t)});-1!==o.indexOf(i.toLowerCase())?/[a-z]/.test(i)?r[s[i.toLowerCase()]].apply(r,_toConsumableArray(n).concat([!1])):r[s[i.toLowerCase()]].apply(r,_toConsumableArray(n).concat([!0])):r.systemError("compile","Key name not found",i)})}else"polygon"===e?(this.readPolyline(t),this.closePath()):"polyline"===e&&this.readPolyline(t)}},{key:"readPolyline",value:function(t){for(var e="",i=0;i<t.length;i++)"-"===t[i]&&(e+=" "),e+=t[i];t=e.split(/,|\s/).filter(function(t){return""!==t}).map(function(t){return Number(t)});this.moveTo(t[0],t[1],!0);for(var n=2;n<t.length;n+=2)this.lineTo(t[n],t[n+1],!0)}},{key:"eachPoint",value:function(t){for(var e=this.points.length,i=0;i<e;i++)t(this.points[i],i)}},{key:"addPoint",value:function(t){t.error&&this.systemError("addPoint",t.error,t),this.points.push(t),this.length+=t.length}},{key:"addPath",value:function(t){t instanceof n?this.compile(t.toPathString()):this.systemError("addPath","Object not a Ppath2D data.",t)}},{key:"refresh",value:function(){var i=this;this.length=0,this.siteCaches=[],this.eachPoint(function(t,e){i.length+=t.length})}},{key:"render",value:function(e){e.beginPath(),this.eachPoint(function(t){t.render(e)})}},{key:"toPathString",value:function(){var e="";return this.eachPoint(function(t){e+=t.toPathString()}),e}},{key:"getLastPoint",value:function(){return 0===this.points.length?{ex:0,ey:0}:this.points.slice(-1)[0]}},{key:"getLastPosition",value:function(){var t=this.points[this.points.length-1];return t?t.getLastPosition():{x:0,y:0}}},{key:"getLinePosition",value:function(t){if(this.cacheMode&&this.siteCaches[t])return this.siteCaches[t];for(var e=null,i=null,n=this.length*t,r=this.points.length,s=0;s<r;s++)if(n<=this.points[s].length){if(this.points[s]){e=this.points[s];break}}else n-=this.points[s].length;return i=e?e.getLinePosition(n/e.length):this.getLastPosition(),this.cacheMode&&this.siteCaches.length<=2e3&&(this.siteCaches[t]=i),i}},{key:"getDirection",value:function(t){var e=t+.01,i=this.getLinePosition(t),n=this.getLinePosition(e);return y.getAngle(i.x,i.y,n.x,n.y)-270}},{key:"moveTo",value:function(t,e){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return this.addPoint(new h.MoveTo(this,this.getLastPoint(),t,e,i)),this}},{key:"lineTo",value:function(t,e){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return this.addPoint(new h.LineTo(this,this.getLastPoint(),t,e,i)),this}},{key:"curve",value:function(t,e,i,n,r,s){var o=6<arguments.length&&void 0!==arguments[6]&&arguments[6];return this.addPoint(new h.Curve(this,this.getLastPoint(),t,e,i,n,r,s,o)),this}},{key:"quadraticBezierCurve",value:function(t,e,i,n){var r=4<arguments.length&&void 0!==arguments[4]&&arguments[4];return this.addPoint(new h.QuadraticBezierCurve(this,this.getLastPoint(),t,e,i,n,r)),this}},{key:"smoothCurve",value:function(t,e,i,n){var r=4<arguments.length&&void 0!==arguments[4]&&arguments[4];return this.addPoint(new h.SmoothCurve(this,this.getLastPoint(),t,e,i,n,r)),this}},{key:"smoothQuadraticBezierCurve",value:function(t,e){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return this.addPoint(new h.SmoothQuadraticBezierCurve(this,this.getLastPoint(),t,e,i)),this}},{key:"horizontalLineTo",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return this.addPoint(new h.HorizontalLineTo(this,this.getLastPoint(),t,e)),this}},{key:"verticalLineTo",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return this.addPoint(new h.VerticalLineTo(this,this.getLastPoint(),t,e)),this}},{key:"arc",value:function(t,e,i,n,r,s,o){var a=7<arguments.length&&void 0!==arguments[7]&&arguments[7];return this.addPoint(new h.Arc(this,this.getLastPoint(),t,e,i,n,r,s,o,a)),this}},{key:"closePath",value:function(){var t=this.points.filter(function(t){return t instanceof h.MoveTo}).pop();return this.addPoint(new h.ClosePath(this,this.getLastPoint(),t)),this}}]),n}(),y=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"getDistance",value:function(t,e,i,n){return Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2))}},{key:"getAngle",value:function(t,e,i,n){if(t==i&&e==n)return 0;var r=180*Math.atan2(n-e,i-t)/Math.PI;return 0<r?r:360+r}},{key:"getSvgLength",value:function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","path");return e.setAttributeNS(null,"d",t),e.getTotalLength()}}]),t}(),h=function(){function n(t,e){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,n),this.error=null,this.absolute=!!i,this.initData(),this.resetReference(t,e)}return _createClass(n,[{key:"resetReference",value:function(t,e){this.path=t,this.parent=e||this.parent}},{key:"initData",value:function(){this.length=0,this.data={p1x:0,p1y:0,p2x:0,p2y:0,ex:0,ey:0}}},{key:"resetData",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];for(var i in t)null!=this.data[i]&&(this[i]=t[i]);this.refresh(e)}},{key:"refresh",value:function(t){this.length=this.getLength(),t&&this.path.refreshLength()}},{key:"getLength",value:function(){return 0}},{key:"getLastPosition",value:function(){return{x:this.ex,y:this.ey}}},{key:"getType",value:function(){return this.toPathString().trim()[0]}},{key:"sx",get:function(){return this.parent.ex}},{key:"sy",get:function(){return this.parent.ey}},{key:"ex",get:function(){return this.absolute?this.data.ex:this.data.ex+this.sx},set:function(t){this.data.ex=t}},{key:"ey",get:function(){return this.absolute?this.data.ey:this.data.ey+this.sy},set:function(t){this.data.ey=t}},{key:"p1x",get:function(){return this.absolute?this.data.p1x:this.data.p1x+this.sx},set:function(t){this.data.p1x=t}},{key:"p1y",get:function(){return this.absolute?this.data.p1y:this.data.p1y+this.sy},set:function(t){this.data.p1y=t}},{key:"p2x",get:function(){return this.absolute?this.data.p2x:this.data.p2x+this.sx},set:function(t){this.data.p2x=t}},{key:"p2y",get:function(){return this.absolute?this.data.p2y:this.data.p2y+this.sy},set:function(t){this.data.p2y=t}}]),n}();h.MoveTo=function(t){function o(t,e,i,n,r){_classCallCheck(this,o);var s=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,e,r));return s.resetData({ex:i,ey:n}),s}return _inherits(o,h),_createClass(o,[{key:"render",value:function(t){t.moveTo(this.ex,this.ey)}},{key:"toPathString",value:function(){return"M"+this.ex+","+this.ey}},{key:"getLinePosition",value:function(t){return{x:this.ex,y:this.ey}}}]),o}(),h.LineTo=function(t){function o(t,e,i,n,r){_classCallCheck(this,o);var s=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,e,r));return s.resetData({ex:i,ey:n}),s}return _inherits(o,h),_createClass(o,[{key:"render",value:function(t){t.lineTo(this.ex,this.ey)}},{key:"toPathString",value:function(){return"L"+this.ex+","+this.ey}},{key:"getLinePosition",value:function(t){return{x:this.sx*(1-t)+this.ex*t,y:this.sy*(1-t)+this.ey*t}}},{key:"getLength",value:function(){return y.getDistance(this.sx,this.sy,this.ex,this.ey)}}]),o}(),h.HorizontalLineTo=function(t){function r(t,e,i,n){return _classCallCheck(this,r),_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e,i,n?e.ey:0,n))}return _inherits(r,h.LineTo),_createClass(r,[{key:"toPathString",value:function(){return"H"+this.ex}}]),r}(),h.VerticalLineTo=function(t){function r(t,e,i,n){return _classCallCheck(this,r),_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e,n?e.ex:0,i,n))}return _inherits(r,h.LineTo),_createClass(r,[{key:"toPathString",value:function(){return"V"+this.ey}}]),r}(),h.Curve=function(t){function c(t,e,i,n,r,s,o,a){var h=8<arguments.length&&void 0!==arguments[8]&&arguments[8];_classCallCheck(this,c);var u=_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,t,e,h));return u.resetData({p1x:i,p1y:n,p2x:r,p2y:s,ex:o,ey:a}),u}return _inherits(c,h),_createClass(c,[{key:"getStep",value:function(){return 100}},{key:"getPoint",value:function(t,e,i,n,r){return e*(1-t)*(1-t)*(1-t)+3*i*(1-t)*(1-t)*t+3*n*(1-t)*t*t+r*t*t*t}},{key:"getLength",value:function(){if(f.GeometryElement)return y.getSvgLength("M"+this.sx+","+this.sy+this.toPathString());for(var t=0,e=0,i=0,n=0,r=this.getStep(),s=0,o=0,a=0;a<=r;a++){if(i=a/r,t=this.getPoint(i,this.sx,this.p1x,this.p2x,this.ex),e=this.getPoint(i,this.sy,this.p1y,this.p2y,this.ey),0<a){var h=t-s,u=e-o;n+=Math.sqrt(h*h+u*u)}s=t,o=e}return n}},{key:"render",value:function(t){t.bezierCurveTo(this.p1x,this.p1y,this.p2x,this.p2y,this.ex,this.ey)}},{key:"toPathString",value:function(){return"C"+this.p1x+","+this.p1y+","+this.p2x+","+this.p2y+","+this.ex+","+this.ey}},{key:"getLinePosition",value:function(t){return{x:this.getPoint(t,this.sx,this.p1x,this.p2x,this.ex),y:this.getPoint(t,this.sy,this.p1y,this.p2y,this.ey)}}}]),c}(),h.QuadraticBezierCurve=function(t){function a(t,e,i,n,r,s){var o=6<arguments.length&&void 0!==arguments[6]&&arguments[6];return _classCallCheck(this,a),_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t,e,i,n,i,n,r,s,o))}return _inherits(a,h.Curve),_createClass(a,[{key:"render",value:function(t){t.quadraticCurveTo(this.p1x,this.p1y,this.ex,this.ey)}},{key:"toPathString",value:function(){return"Q"+this.p1x+","+this.p1y+","+this.ex+","+this.ey}},{key:"getPoint",value:function(t,e,i,n,r){return(1-t)*(1-t)*e+2*t*(1-t)*i+t*t*r}},{key:"p2x",get:function(){return this.p1x},set:function(t){this.data.p2x=t}},{key:"p2y",get:function(){return this.p1y},set:function(t){this.data.p2y=t}}]),a}(),h.SmoothCurve=function(t){function a(t,e,i,n,r,s){var o=6<arguments.length&&void 0!==arguments[6]&&arguments[6];return _classCallCheck(this,a),_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t,e,0,0,i,n,r,s,o))}return _inherits(a,h.Curve),_createClass(a,[{key:"render",value:function(t){t.bezierCurveTo(this.p1x,this.p1y,this.p2x,this.p2y,this.ex,this.ey)}},{key:"toPathString",value:function(){return"S"+this.p2x+","+this.p2y+","+this.ex+","+this.ey}},{key:"parentIsCurve",get:function(){return!!this.parent.getType().toLowerCase().match(/q|c|s|t/)}},{key:"p1x",get:function(){return this.parentIsCurve?2*this.parent.ex-this.parent.p2x:this.p2x},set:function(t){this.data.p1x=t}},{key:"p1y",get:function(){return this.parentIsCurve?2*this.parent.ey-this.parent.p2y:this.p2y},set:function(t){this.data.p1y=t}}]),a}(),h.SmoothQuadraticBezierCurve=function(t){function o(t,e,i,n){var r=4<arguments.length&&void 0!==arguments[4]&&arguments[4];_classCallCheck(this,o);var s=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,e,0,0,0,0,i,n,r));return"q"!==e.getType().toLowerCase()&&(s.error="Smooth Quadratic BezierCurve previous point must a Quadratic Bezier Curve."),s}return _inherits(o,h.Curve),_createClass(o,[{key:"render",value:function(t){t.quadraticCurveTo(this.p1x,this.p1y,this.ex,this.ey)}},{key:"toPathString",value:function(){return"T"+this.ex+","+this.ey}},{key:"getPoint",value:function(t,e,i,n,r){return(1-t)*(1-t)*e+2*t*(1-t)*i+t*t*r}},{key:"p2x",get:function(){return this.p1x},set:function(t){}},{key:"p2y",get:function(){return this.p1y},set:function(t){}},{key:"p1x",get:function(){return 2*this.parent.ex-this.parent.p1x},set:function(t){}},{key:"p1y",get:function(){return 2*this.parent.ey-this.parent.p1y},set:function(t){}}]),o}(),h.Arc=function(t){function l(t,e,i,n,r,s,o,a,h){var u=9<arguments.length&&void 0!==arguments[9]&&arguments[9];_classCallCheck(this,l);var c=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,t,e,u));return c.rx=i,c.ry=n,c.sweepFlag=o,c.largeArcFlag=s,c.xAxisRotation=r,c.resetData({ex:a,ey:h}),c}return _inherits(l,h),_createClass(l,[{key:"resetData",value:function(t){this.rx=t.rx?t.rx:this.rx,this.ry=t.ry?t.ry:this.ry,this.sweepFlag=t.sweepFlag?t.sweepFlag:this.sweepFlag,this.largeArcFlag=t.largeArcFlag?t.largeArcFlag:this.largeArcFlag,this.xAxisRotation=t.xAxisRotation?t.xAxisRotation:this.xAxisRotation,_get(l.prototype.__proto__||Object.getPrototypeOf(l.prototype),"resetData",this).call(this,t)}},{key:"getStep",value:function(){return 100}},{key:"render",value:function(t){for(var e=this.getStep(),i=0;i<e;i+=1){var n=this.getLinePosition(i/e);t.lineTo(n.x,n.y)}}},{key:"toPathString",value:function(){return"A"+this.rx+","+this.ry+","+this.xAxisRotation+","+this.largeArcFlag+","+this.sweepFlag+","+this.ex+","+this.ey}},{key:"angleBetween",value:function(t,e){var i=t.x*e.x+t.y*e.y,n=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(i/n)}},{key:"getLinePosition",value:function(t){var e=Math.abs(this.rx),i=Math.abs(this.ry),n=Math.pow(e,2),r=Math.pow(i,2),s=this.xAxisRotation%360*(Math.PI/180),o=Math.cos(s),a=Math.sin(s);if(this.sx===this.ex&&this.sy===this.ey)return{x:this.sx,y:this.sy};if(0===e||0===i)return{x:this.sx*(1-t)+this.ex*t,y:this.sy*(1-t)+this.ey*t};var h=(this.sx-this.ex)/2,u=(this.sy-this.ey)/2,c={x:o*h+a*u,y:-a*h+o*u},l=Math.pow(c.x,2),y=Math.pow(c.y,2),f=l/n+y/r;if(1<f){var p=Math.sqrt(f);e*=p,i*=p}var g=(n*r-n*y-r*l)/(n*y+r*l);g=g<0?0:g;var v=(this.largeArcFlag!==this.sweepFlag?1:-1)*Math.sqrt(g),x=v*(e*c.y/i),d=v*(-i*c.x/e),_=o*x-a*d+(this.sx+this.ex)/2,k=a*x+o*d+(this.sy+this.ey)/2,C={x:(c.x-x)/e,y:(c.y-d)/i},P=this.angleBetween({x:1,y:0},C),b={x:(-c.x-x)/e,y:(-c.y-d)/i},m=this.angleBetween(C,b),L=2*Math.PI;!this.sweepFlag&&0<m?m-=L:this.sweepFlag&&m<0&&(m+=L);var w=P+(m%=L)*t,M=e*Math.cos(w),S=i*Math.sin(w);return{x:o*M-a*S+_,y:a*M+o*S+k}}},{key:"getDistance",value:function(t,e){return y.getDistance(t.x,t.y,e.x,e.y)}},{key:"getLength",value:function(){if(f.GeometryElement)return y.getSvgLength("M"+this.sx+","+this.sy+this.toPathString());for(var t,e=this.getStep(),i=0,n=this.getLinePosition(0),r=0;r<e;r++){var s=Math.min(Math.max(r*(1/e),0),1);t=this.getLinePosition(s),i+=this.getDistance(n,t),n=t}return t=this.getLinePosition(1),i+=this.getDistance(n,t)}}]),l}(),h.ClosePath=function(t){function n(t,e,i){return _classCallCheck(this,n),_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e,i.ex,i.ey,i.absolute))}return _inherits(n,h.LineTo),_createClass(n,[{key:"render",value:function(t){t.closePath()}},{key:"toPathString",value:function(){return"z"}}]),n}();var f={Path2D:!!Path2D,GeometryElement:function(){try{return y.getSvgLength("M0,0"),!0}catch(t){return!1}}()};return t});